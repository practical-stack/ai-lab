---
title: "모듈 4: 실용적 설계 템플릿"
description: "Command, Skill, Agent를 위한 바로 사용 가능한 스펙 템플릿과 필수/선택 섹션 가이드"
type: tutorial
tags: [AI, Architecture, BestPractice]
order: 4
depends_on: [./03-decision-framework.ko.md]
related: [./04-templates.en.md]
---

# 모듈 4: 실용적 설계 템플릿

> Command, Skill, Agent를 위한 바로 사용 가능한 스펙 템플릿

## 학습 목표

이 모듈을 완료하면:
- 모든 컴포넌트 유형을 설계하는 템플릿을 사용할 수 있습니다
- 필수 섹션과 선택 섹션을 알게 됩니다
- 전문적인 품질의 스펙을 작성할 수 있습니다

---

## 4.1 템플릿이 중요한 이유

템플릿은 다음을 보장합니다:
- **일관성** - 컴포넌트 간 통일된 형식
- **완전성** - 빠진 섹션 없음
- **커뮤니케이션** - 팀이 설계를 이해
- **유지보수성** - 미래 개발자가 의도를 이해

---

## 4.2 Command 스펙 템플릿

### 템플릿

```markdown
# Command: [command-name]

> [이 커맨드가 하는 일에 대한 한 줄 설명]

## 개요

| 속성 | 값 |
|------|-----|
| **이름** | `/[command-name]` |
| **버전** | 1.0.0 |
| **담당자** | [팀/담당자] |

## 목적

[커맨드의 목표를 설명하는 2-3문장]

## 범위 외

- [이 커맨드가 하지 않는 것]
- [사용자가 알아야 할 제한사항]

---

## 입력

### 매개변수

| 매개변수 | 타입 | 필수 | 기본값 | 설명 |
|----------|------|------|--------|------|
| `param1` | string | 예 | - | [설명] |
| `param2` | string | 아니오 | `"default"` | [설명] |
| `--flag` | flag | 아니오 | false | [설명] |

### 입력 예시

```
/[command-name] value1 --flag
/[command-name] value1 value2
```

---

## 프로세스

1. **검증** - [먼저 검증되는 것]
2. **단계 2** - [다음 액션]
3. **단계 3** - [다음 액션]
4. **결과** - [최종 출력]

---

## 출력

### 성공 응답

```
✅ [성공 메시지 형식]
[추가 상세 정보]
```

### 실패 응답

```
❌ [오류 유형] - [오류 메시지 형식]
```

### 생성되는 산출물

| 산출물 | 위치 | 설명 |
|--------|------|------|
| [파일/로그] | [경로] | [포함 내용] |

---

## 오류 처리

| 오류 코드 | 조건 | 복구 방법 |
|-----------|------|-----------|
| `INVALID_PARAM` | [이 상황 발생 시] | [복구 방법] |
| `TIMEOUT` | [이 상황 발생 시] | [복구 방법] |
| `PARTIAL_FAIL` | [이 상황 발생 시] | [복구 방법] |

---

## 안전

### 실행 전
- [ ] [사전 조건 확인]

### 확인 필요
- [위험한 액션] → 사용자에게 묻기: "[확인 질문]"

### 속도 제한
- [속도 제한 규칙]

---

## 관측성

### 로깅
- 태그: `COMMAND=[command-name]`
- 필드: [field1], [field2]

### 메트릭
- `[metric_name]` - [측정 대상]

---

## 테스팅

| 테스트 유형 | 설명 |
|-------------|------|
| **단위** | [테스트할 것] |
| **통합** | [테스트할 것] |
| **엣지 케이스** | [테스트할 것] |
```

### 작성 예시

```markdown
# Command: deploy

> 지정된 환경에 애플리케이션 배포

## 개요

| 속성 | 값 |
|------|-----|
| **이름** | `/deploy` |
| **버전** | 1.0.0 |
| **담당자** | DevOps 팀 |

## 목적

최신 코드를 지정된 환경(dev, staging, prod)에 배포합니다.
배포 전 체크를 실행하고 완료 시 팀에 알립니다.

## 범위 외

- 인프라 프로비저닝 안 함
- 데이터베이스 마이그레이션 처리 안 함 (별도 `/migrate` 사용)

---

## 입력

### 매개변수

| 매개변수 | 타입 | 필수 | 기본값 | 설명 |
|----------|------|------|--------|------|
| `env` | string | 예 | - | 대상 환경: `dev`, `staging`, `prod` |
| `--dry-run` | flag | 아니오 | false | 실제 배포 없이 시뮬레이션 |
| `--version` | string | 아니오 | latest | 배포할 특정 버전 |

### 입력 예시

```
/deploy dev
/deploy prod --dry-run
/deploy staging --version 1.2.3
```

---

## 프로세스

1. **검증** - env가 유효한지, 사용자 권한 확인
2. **사전 검사** - 대상 환경 헬스 체크 실행
3. **배포** - 배포 스크립트 실행
4. **확인** - 스모크 테스트 실행
5. **알림** - #deploys 채널에 완료 메시지 전송

---

## 출력

### 성공 응답

```
✅ **prod**에 배포 성공
버전: 1.2.3
소요 시간: 2분 34초
헬스 체크: 모든 서비스 정상
```

### 실패 응답

```
❌ DEPLOY_FAILED - 배포 후 헬스 체크 실패
이전 버전(1.2.2)으로 롤백됨
로그 확인: /logs/deploy-2024-01-15.log
```

---

## 오류 처리

| 오류 코드 | 조건 | 복구 방법 |
|-----------|------|-----------|
| `INVALID_ENV` | env가 [dev, staging, prod]에 없음 | 오류 반환, 액션 없음 |
| `NO_PERMISSION` | 사용자가 해당 env에 배포 불가 | 오류 반환, 담당자 연락 안내 |
| `DEPLOY_TIMEOUT` | 배포가 10분 초과 | 취소, 롤백, 팀 알림 |
| `HEALTH_FAILED` | 배포 후 체크 실패 | 자동 롤백, 알림 |

---

## 안전

### 실행 전
- [ ] 해당 버전에 대해 CI 통과 확인
- [ ] 대상 env에 활성 인시던트 없는지 확인

### 확인 필요
- `prod` 배포 → 묻기: "프로덕션에 배포합니다. 확실합니까? (yes/no)"

### 속도 제한
- 프로덕션 배포: 시간당 최대 1회
- 스테이징 배포: 시간당 최대 5회
```

---

## 4.3 Skill 스펙 템플릿

### 템플릿

```markdown
# Skill: [skill-name]

> [한 줄 설명]

---
name: [skill-name]
version: 1.0.0
description: |
  [상세 설명]
  USE WHEN: [트리거 키워드/상황]
  DO NOT USE WHEN: [제외 케이스]
---

## 개요

| 속성 | 값 |
|------|-----|
| **도메인** | [도메인 영역] |
| **담당자** | [팀/담당자] |
| **관련 Skill** | [다른 스킬들] |

## 폴더 구조

```
skills/
└── [skill-name]/
    ├── SKILL.md           # 이 파일
    ├── workflows/
    │   ├── [workflow-1].md
    │   └── [workflow-2].md
    └── references/
        └── [reference].md
```

---

## 워크플로우 라우팅

| 사용자 의도 | 워크플로우 파일 | 설명 |
|-------------|-----------------|------|
| "[의도 1]" | workflows/[file].md | [하는 일] |
| "[의도 2]" | workflows/[file].md | [하는 일] |

---

## 트리거 조건

### 로드할 때
- 키워드: "[keyword1]", "[keyword2]"
- 컨텍스트: [컨텍스트 설명]

### 로드하지 않을 때
- [제외 조건]
- [또 다른 제외]

---

## 전제 조건

Agent가 접근해야 하는 것:
- [필요한 컨텍스트/파일]
- [필요한 도구]

---

## 핵심 가이드라인

1. [가이드라인 1]
2. [가이드라인 2]
3. [가이드라인 3]

---

## 성공 기준

다음 조건이 충족되면 skill이 성공적으로 적용됨:
- [ ] [기준 1]
- [ ] [기준 2]

---

## 테스팅

| 테스트 | 설명 |
|--------|------|
| **트리거 테스트** | "[트리거 문구]"에서 skill 로드 확인 |
| **부정 테스트** | "[제외 문구]"에서 skill 로드 안 됨 확인 |
| **콘텐츠 테스트** | 워크플로우가 예상 출력 생성 확인 |
```

### 작성 예시

```markdown
# Skill: code-review

> 코드 리뷰를 위한 가이드라인과 체크리스트 제공

---
name: code-review
version: 1.0.0
description: |
  버그, 보안 이슈, 유지보수성 문제를 잡기 위한 종합 코드 리뷰 전문 지식.
  USE WHEN: "코드 리뷰", "PR 확인", "코드 품질", "변경 리뷰"
  DO NOT USE WHEN: "새 코드 작성", "리팩토링" (대신 coding-guidelines 사용)
---

## 개요

| 속성 | 값 |
|------|-----|
| **도메인** | 코드 품질 |
| **담당자** | 플랫폼 팀 |
| **관련 Skill** | security-review, testing |

## 폴더 구조

```
skills/
└── code-review/
    ├── SKILL.md
    ├── workflows/
    │   ├── general-review.md
    │   ├── security-focus.md
    │   └── performance-focus.md
    └── references/
        └── common-issues.md
```

---

## 워크플로우 라우팅

| 사용자 의도 | 워크플로우 파일 | 설명 |
|-------------|-----------------|------|
| "이 PR 리뷰해줘" | workflows/general-review.md | 전체 리뷰 체크리스트 |
| "보안 확인해줘" | workflows/security-focus.md | 보안 집중 리뷰 |
| "성능 괜찮아?" | workflows/performance-focus.md | 성능 분석 |

---

## 트리거 조건

### 로드할 때
- 키워드: "리뷰", "코드 리뷰", "PR 리뷰", "코드 확인"
- 컨텍스트: 사용자가 diff를 제공하거나 코드 품질에 대해 문의

### 로드하지 않을 때
- 사용자가 새 코드 작성 중 (coding-guidelines 사용)
- 사용자가 디버깅 중 (debugging skill 사용)

---

## 핵심 가이드라인

1. **구체적으로** - 각 이슈에 정확한 파일:라인 참조
2. **우선순위 정하기** - 스타일보다 버그/보안에 집중
3. **건설적으로** - 문제만 지적하지 말고 수정 제안
4. **이유 설명** - 작성자가 배울 수 있도록 도움

---

## 성공 기준

다음 조건이 충족되면 skill이 성공적으로 적용됨:
- [ ] 모든 중요 이슈가 파일:라인 참조와 함께 식별됨
- [ ] 각 이슈에 제안된 수정 포함
- [ ] 리뷰가 심각도별로 정리됨 (중요 → 경미)
```

---

## 4.4 Agent 스펙 템플릿

### 템플릿

```markdown
# Agent: [agent-name]

> [에이전트 역할에 대한 한 줄 설명]

## 개요

| 속성 | 값 |
|------|-----|
| **이름** | [agent-name] |
| **버전** | 1.0.0 |
| **모델** | [Claude-3, GPT-4 등] |
| **담당자** | [팀/담당자] |

## 목표

[이 에이전트가 달성하는 것을 설명하는 2-3문장]

## 범위

### 범위 내
- [책임 1]
- [책임 2]

### 범위 외
- [하지 않는 것]
- [경계]

---

## 역량

### 사용 Skill
| Skill | 목적 |
|-------|------|
| [skill-name] | [이 에이전트가 사용하는 이유] |

### 사용 가능한 도구
| 도구 | 목적 | 권한 |
|------|------|------|
| [tool-name] | [하는 일] | [읽기/쓰기/실행] |

### 액션

**할 수 있는 것:**
- [자율 액션 1]
- [자율 액션 2]

**승인 필요:**
- [사람 확인 필요한 액션]

**할 수 없는 것:**
- [금지된 액션]

---

## 워크플로우

### 고수준 프로세스

```
1. [첫 번째 주요 단계]
   └── [필요시 하위 단계]
2. [두 번째 주요 단계]
3. [계속...]
```

### 결정 포인트

| 조건 | 액션 |
|------|------|
| [X 발생 시] | [Y 수행] |
| [A이고 B일 때] | [C 수행] |

---

## 입력/출력

### 입력 형식
```json
{
  "field1": "설명",
  "field2": "설명"
}
```

### 출력 형식
```json
{
  "result": "설명",
  "details": {}
}
```

---

## 오류 처리

| 시나리오 | 처리 |
|----------|------|
| [오류 유형] | [대응] |
| [최대 재시도 초과] | [발생하는 일] |
| [타임아웃] | [발생하는 일] |

---

## 제약사항

### 리소스 제한
- 최대 단계: [N]
- 타임아웃: [M초]
- 최대 서브에이전트: [X]

### 안전 규칙
- [규칙 1]
- [규칙 2]

---

## 관측성

### 로깅
- 태그: `AGENT=[agent-name]`
- 주요 이벤트: [목록]

### 메트릭
- [metric_name] - [설명]

---

## 테스팅

| 테스트 유형 | 시나리오 |
|-------------|----------|
| **정상 경로** | [정상 흐름 테스트] |
| **오류 케이스** | [테스트할 것] |
| **엣지 케이스** | [비정상적이지만 유효한 시나리오] |
```

### 작성 예시

```markdown
# Agent: bug-fix-agent

> 버그 리포트를 분석하고, 근본 원인을 찾고, 수정 PR을 생성

## 개요

| 속성 | 값 |
|------|-----|
| **이름** | bug-fix-agent |
| **버전** | 1.0.0 |
| **모델** | Claude-3-Opus |
| **담당자** | 엔지니어링 플랫폼 |

## 목표

리포트부터 PR까지 버그 수정 프로세스를 자동화하여 개발자의 수고와
일반적인 버그 패턴의 수정 시간을 줄입니다.

## 범위

### 범위 내
- 버그 리포트 분석 및 이슈 재현
- 근본 원인 코드베이스 검색
- 수정 생성 및 테스트
- 명확한 설명이 포함된 draft PR 열기

### 범위 외
- 인프라/DevOps 이슈
- UI/UX 버그 (ui-bug-agent 사용)
- PR 머지 (사람 리뷰 필요)

---

## 역량

### 사용 Skill
| Skill | 목적 |
|-------|------|
| debugging | 오류 분석 기법 |
| coding-guidelines | 수정이 표준 준수 보장 |
| testing | 수정용 테스트 작성/실행 |

### 사용 가능한 도구
| 도구 | 목적 | 권한 |
|------|------|------|
| file_search | 관련 코드 찾기 | 읽기 |
| file_edit | 수정 적용 | 쓰기 (src/ 전용) |
| test_runner | 수정 확인 | 실행 |
| github_api | PR 생성 | draft PR만 생성 |

### 액션

**할 수 있는 것:**
- 저장소의 모든 파일 읽기
- 소스 코드 파일 편집
- 로컬 테스트 실행
- draft PR 생성

**승인 필요:**
- 원격 브랜치 푸시
- 새 의존성 추가

**할 수 없는 것:**
- PR 머지
- 파일 삭제
- 프로덕션 설정 수정

---

## 워크플로우

```
1. 이해 - 버그 리포트 파싱
   └── 필요시 명확화 질문
2. 재현 - 버그 트리거 시도
   └── 재현 불가시 추가 정보 요청
3. 조사 - 근본 원인 찾기
   └── file_search 사용, 로그 읽기
4. 수정 - 최소한의 수정 적용
   └── coding-guidelines skill 따르기
5. 확인 - 테스트 실행
   └── 테스트 실패시 반복 (최대 2회)
6. PR - draft PR 생성
   └── 버그 원인과 수정 설명 포함
7. 보고 - 사용자에게 요약
```

---

## 오류 처리

| 시나리오 | 처리 |
|----------|------|
| 재현 불가 | 단계 요청, 환경 상세. 2회 시도 후 실패. |
| 원인 못 찾음 | 조사 결과 보고, 수동 디버그 제안. |
| 수정 후 테스트 실패 | 수정 재시도 (최대 2회). 그 후 노트와 함께 WIP PR 생성. |
| 타임아웃 | 진행 상황 저장, 부분 결과 보고. |

---

## 제약사항

### 리소스 제한
- 최대 단계: 15
- 타임아웃: 10분
- 최대 서브에이전트: 2 (병렬 조사용)

### 안전 규칙
- 테스트 통과를 위해 테스트 assertion 수정 금지
- 항상 버그가 무엇이고 수정이 왜 동작하는지 설명
- 수정 완료 주장 전 반드시 테스트 실행
```

---

## 4.5 템플릿 빠른 참조

### 최소 Command

```markdown
# Command: /[name]

**목적:** [한 줄]

**입력:** `[매개변수]`

**출력:** [예상 결과]

**오류:** [주요 오류 케이스]
```

### 최소 Skill

```yaml
---
name: [skill-name]
description: |
  [하는 일]
  USE WHEN: [트리거]
---

## 워크플로우 라우팅
| 의도 | 파일 |
|------|------|
| [x] | workflows/[x].md |
```

### 최소 Agent

```yaml
name: [agent-name]
goal: [달성하는 것]
skills: [목록]
tools: [목록]
constraints:
  max_steps: N
  requires_approval: [위험한 액션]
```

---

## 핵심 정리

1. **템플릿 사용** - 일관성과 완전성 보장
2. **모든 필수 섹션 작성** - 간략해도 됨
3. **구체적으로** - 모호한 스펙은 모호한 구현으로 이어짐
4. **오류 처리 포함** - 정상 경로만으로는 부족
5. **제약사항 문서화** - 제한이 폭주하는 에이전트를 방지

---

## 다음 모듈

[모듈 5: 실전 예제](./05-examples.ko.md) - Command, Skill, Agent의 완전한 구현을 살펴봅니다.
